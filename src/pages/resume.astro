---
import BaseLayout from "@/layouts/BaseLayout.astro";

// Import markdown file as component
const { Content, rawContent } = await import("../resume.md");
const resumeRaw = rawContent();
---

<BaseLayout title="Daniel Ives | Resume">
  <!-- Mobile: icons only -->
  <div slot="nav" class="md:hidden absolute top-2 right-6 flex gap-2">
    <button
      id="copy-mobile"
      class="p-2 relative"
      aria-label="Copy as markdown"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
      </svg>
      <span id="toast-mobile" class="absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs bg-black dark:bg-white text-white dark:text-black px-2 py-1 rounded whitespace-nowrap opacity-0 transition-opacity pointer-events-none">
        Copied as markdown
      </span>
    </button>
    <a
      href="/Daniel Ives Resume.pdf"
      download="Daniel Ives Resume.pdf"
      class="p-2 no-underline"
      aria-label="Download PDF"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
      </svg>
    </a>
  </div>

  <!-- Desktop: full navbar -->
  <nav slot="nav" class="hidden md:block absolute top-8 left-6 right-6 pb-2 border-b border-gray-200 dark:border-gray-700">
    <div class="flex justify-between items-center">
      <a href="/" data-astro-prefetch>‚Üê Back to home</a>
      <div class="flex gap-2">
        <button
          id="copy-desktop"
          class="p-2 relative hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition-colors cursor-pointer"
          aria-label="Copy as markdown"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
          </svg>
          <span id="toast-desktop" class="absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs bg-black dark:bg-white text-white dark:text-black px-2 py-1 rounded whitespace-nowrap opacity-0 transition-opacity pointer-events-none">
            Copied as markdown
          </span>
        </button>
        <a
          href="/Daniel Ives Resume.pdf"
          download="Daniel Ives Resume.pdf"
          class="p-2 no-underline hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition-colors"
          aria-label="Download PDF"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
        </a>
      </div>
    </div>
  </nav>

  <article class="prose prose-sm prose-slate dark:prose-invert dark:prose-headings:text-white dark:prose-p:text-white dark:prose-a:text-white max-w-none">
    <Content />
  </article>

  <script id="resume-data" type="application/json" set:html={JSON.stringify(resumeRaw)} />
  
  <script>
    const resumeMarkdown = JSON.parse(document.getElementById('resume-data')?.textContent || '""');
    
    function copyMarkdown(toastId: string) {
      navigator.clipboard.writeText(resumeMarkdown);
      const toast = document.getElementById(toastId);
      if (toast) {
        toast.style.opacity = '1';
        setTimeout(() => toast.style.opacity = '0', 2000);
      }
    }
    
    document.getElementById('copy-mobile')?.addEventListener('click', () => copyMarkdown('toast-mobile'));
    document.getElementById('copy-desktop')?.addEventListener('click', () => copyMarkdown('toast-desktop'));
  </script>
</BaseLayout>
